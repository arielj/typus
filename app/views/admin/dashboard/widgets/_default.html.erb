<%
  applications = admin_user.applications

  if params[:application]
    applications.reject! { |a| a.parameterize != params[:application] }
  end
%>

<div class="col-md-12">

  <h2><%= t('typus.dashboard.title') %></h2>

  <% if applications.any? %>
    <% applications.each do |app| %>

      <table class="table">

        <thead>
          <tr>
            <th><%= t("typus.application.#{app.parameterize(separator: '_')}", default: app) %></th>
          </tr>
        </thead>

        <% admin_user.application(app).map(&:constantize).each do |klass| %>
          <% unless klass.typus_options_for(:hide_from_dashboard) %>
            <tr>
              <td>
                <%= link_to klass.model_name.human(count: 1_000), controller: "/admin/#{klass.to_resource}" %>
              </td>
            </tr>
          <% end %>
        <% end %>

      </table>

    <% end %>
  <% else %>
    <div class="notice">
      <%= t('typus.dashboard.no_applications') %>
    </div>
  <% end %>

  <% if Typus.dashboard_show_tableless -%>
    <% rs = admin_user.tableless_resources %>
    <% if rs.any? %>
      <table class="table">
        <thead>
          <tr>
            <th><%= t("typus.application.tableless_resources", default: 'Others') %></th>
          </tr>
        </thead>

        <% rs.each do |r| %>
          <tr>
            <td>
              <%= link_to r, "/admin/#{r.underscore}" %>
            </td>
          </tr>
        <% end %>
      </table>
    <% end %>
  <% end %>
</div>
